<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>zwon's Link Memo</title>

    <!--flask render_template ì‚¬ìš© ì‹œ, css ë§í¬-->
    <link rel="stylesheet" href="{{url_for('static', filename='style.css')}}">

    <!-- êµ¬ê¸€ í°íŠ¸ -->
    <link href="https://fonts.googleapis.com/css?family=Noto+Sans+KR:400,700|Syncopate:400,700&display=swap"
        rel="stylesheet">

    <!-- Jquery -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

    <!-- JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
        integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous">
    </script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
        integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous">
    </script>
</head>

<body>
    <div class="header">
        <h1> link archive </h1>
        <p class="wtbc">Websites to be checked. by zwon</p>
        <button id="button_open_id" onclick="openClose()" class="button_open" type="button">
            â˜ï¸
        </button>
    </div>

    <div id="form_box_id" class="form_box">
        <form>
            <div class="form_part">
                <label for="controlInput1">url :</label>
                <input type="text" id="posting_url_id" class="form_control" placeholder="paste the link">
            </div>

            <div class="form_part">
                <label for="controlInput2">comment :</label>
                <input type="text" id="posting_comment_id" class="form_control" placeholder="what do I think about it?">
            </div>

            <div class="button_save" onclick="posting()"></div>

        </form>
    </div>

    <div id="card_container_id" class="card_container">

        <!-- <div class="card">
            <div class="card_image"
                style="background-image: url(https://greatoceanroadmelbournetours.com.au/wp-content/uploads/2015/04/koala-sleeping.jpg)">
            </div>
            <div class="card_body">
                <h2 class="card_title">LINk ì œëª©ì…ë‹ˆë‹¤ adc</h2>
                <p class="card_text">ê¸°ì‚¬ ë‚´ìš©ì´ ë“¤ì–´ê°‘ë‹ˆë‹¤.</p>
                <p class="card_comment">ì½”ë©˜íŠ¸ê°€ ë‚¨ìŠµë‹ˆë‹¤.</p>
            </div>
        </div> -->




        <div class="clr"></div>
    </div> <!-- card_container ëë‚˜ëŠ” ê³³-->


</body>

<!-- í¬ìŠ¤íŒ…ë“¤ì„ ë¶ˆëŸ¬ì˜¤ëŠ” í•¨ìˆ˜ëŠ” getPosting()
        ì´ê²Œ ì°½ì„ ì¼¤ë•Œë§ˆë‹¤ ìë™ìœ¼ë¡œ ì‹¤í–‰ë˜ì–´ì„œ ì—¬íƒœê¹Œì§€ì˜ postingì„ ìë™ìœ¼ë¡œ ë³´ì—¬ì¤˜ì•¼í•˜ë‹ˆê¹Œ
        í˜ì´ì§€ ë¡œë”©ì´ ëë‚˜ë©´ getPosting í•¨ìˆ˜ê°€ ìë™ìœ¼ë¡œ ì‹œì‘ë˜ê²Œ ë” -->
<script>
    window.onload = function () {
        getPosting();
    }

    function getPosting() {
        $('#card_container_id').empty('');
        $.ajax({
            type: "GET",
            url: "/post",
            data: {},
            success: function (response) {
                let cards = response['articles'];
                for (let i = 0; i < cards.length; i++) {
                    let url = cards[i]['url'];
                    let comment = cards[i]['comment'];
                    let title = cards[i]['title'];
                    let image = cards[i]['image'];
                    let desc = cards[i]['desc'];
                    // ì—¬ê¸°ì—ì„œ ì•„ê¹Œ ë§Œë“¤ì–´ë†“ì€ makeCard í•¨ìˆ˜ë¥¼ ì ìš©í•´ì£¼ëŠ” ê²ƒ!!!
                    makeCard(url, comment, title, image, desc);
                }
            }
        })
    }



    // <!--ì¹´ë“œë¥¼ ë§Œë“¤ì–´ ë¶™ì—¬ì£¼ëŠ” í•¨ìˆ˜

    function makeCard(url, comment, title, image, desc) {
        let oneCard = '<div class="card">\
                        <div class="card_image"\
                            style="background-image: url(' + image + ')">\
                        </div>\
                        <div class="card_body">\
                            <a class="card_title" target="_blank" href="' + url + '">' + title + '</a>\
                            <p class="card_text">' + desc + '...</p>\
                            <p class="card_comment">"' + comment + '"</p>\
                        </div>\
                    </div>'
        $('#card_container_id').append(oneCard);
    }




    // <
    // !--ì´ì œ inputì— urlê³¼ commentë¥¼ ì‘ì„± í›„ button_save ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ë©´,
    // ajaxë¥¼ í†µí•´ ê±´ë‚´ì£¼ëŠ” ê²ƒ!!!
    //     ì €ì¥ì€ flask ìª½ì—ì„œ...
    //     ì €ì¥ì´ ì˜ ëë‹¤ë©´(ì˜ ë³´ë‚´ì¡Œë‹¤ë©´) ì œëŒ€ë¡œ ì €ì¥ì´ ëë‹¤ê³  alert!-- >

    function posting() {
        let url = $('#posting_url_id').val();
        let comment = $('#posting_comment_id').val();
        console.log(url, comment);
        // debugger
        $.ajax({
            type: "POST",
            url: "/post",
            data: {
                url_give: url,
                comment_give: comment
            },
            success: function (response) {
                console.log(response);
                console.log('success,', response);
                if (response['result'] == 'success') {
                    alert('ì„±ê³µì ìœ¼ë¡œ ì €ì¥!ğŸŒŸ');
                    window.location.reload();
                } else {
                    alert('ì €ì¥ ì˜¤ë¥˜ â›ˆ')
                }
            },
            error: function (errorAlert) {
                alert('ì €ì¥ ì˜¤ë¥˜ â›ˆ')
            }
        })
    }

    // function posting() {
    //     // ì½ê¸°
    //     let url = $('#posting_url_id').val();
    //     let comment = $('#posting_comment_id').val();
    //     console.log(url, comment);
    //     // debugger
    //     // alert(url + ' / ' + comment);
    //     $.ajax({
    //         type: "POST", // POST ë°©ì‹ìœ¼ë¡œ ìš”ì²­í•˜ê² ë‹¤.
    //         url: "/post", // /postë¼ëŠ” urlì— ìš”ì²­í•˜ê² ë‹¤.
    //         data: {
    //             url_give: url,
    //             comment_give: comment
    //         }, // ë°ì´í„°ë¥¼ ì£¼ëŠ” ë°©ë²•
    //         success: function (result) { // ì„±ê³µí•˜ë©´
    //             console.log(result); // ì½˜ì†” ì°½ì— ê²°ê³¼ë¥¼ ì°ì–´ì£¼ì
    //         }
    //     })

    // }




    //     <
    //     !--button_open_idë¥¼ ëˆ„ë¥´ë©´ form_box_idê°€ ì—´ë ¸ë‹¤ ë‹«í˜”ë‹¤
    // block(ì—´ë¦°) ìƒíƒœì—ì„œ ëˆ„ë¥´ë©´ hide + êµ¬ë¦„ ì´ëª¨ì§€
    // else(ì¦‰, none, ë‹«íŒ) ìƒíƒœì—ì„œ ëˆ„ë¥´ë©´ show!+ë¬´ì§€ê°œ ì´ëª¨ì§€!-- >

    function openClose() {
        if ($('#form_box_id').css('display') == 'block') {
            $('#form_box_id').hide();
            $('#button_open_id').text('â˜ï¸')
        } else {
            $('#form_box_id').show();
            $('#button_open_id').text('ğŸŒˆ')
        }
    }
</script>


</html>